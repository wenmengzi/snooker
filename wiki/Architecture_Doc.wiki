#labels 关于snooker的,整体架构
*关于snooker的整体架构*

= Introduction =

架构说明书（草拟），设计说明书的依据，功能测试的依据，以及约定和规范。


= Details =

*0、软件定义

    该软件将是一款，网络在线对战斯诺克游戏，由服务器和客户端构成，玩家在客户端和其它在线的玩家一起创建球桌，进行比赛以及观看他人比赛，同时还能进行网络聊天。

*1、开发方式

    采用面向对象的开发方法多人共同完成。任务分成单独的模块，模块之间要保持清晰的界限，原则是使用尽可能少的接口，相关文档要包括接口的功能和使用说明以及测试用例。（详细情况后面会说明）

*2、构成模块

    2-1游戏引擎（母体）

        实现功能：画面渲染，声音播放，游戏逻辑，用户交互。
        2-1-1画面渲染 在游戏时钟的作用下，渲染动画，包括球桌、球、球杆以及其它特效等。

        2-1-2声音播放 同上，包括撞击的声音、落袋的声音、开始/结束游戏的声音以及奖励的声音等。

        2-1-3游戏逻辑 主要是事件的报告和处理，比如碰撞事件，进球事件，游戏开始/结束事件等，将改变游戏的状态以及某种相应处理，事件采用消息机制向（2-1-5）报告，将自定义一组消息专门用于处理游戏消息，由游戏消息处理过程实现。

        2-1-4用户交互 以同样消息的形式向（2-1-5）报告，实现用户的操作改变游戏的某些对象（如球杆），包括鼠标消息、键盘消息。

        2-1-5游戏消息处理过程

            2-1-5-1游戏状态 记录游戏的当前状态，做为某些逻辑判断的依据，包括用户未登入状态/已登入状态，可操作状态/不可操作状态。

            2-1-5-2鼠标消息的处理 在可操作状态下，控制白球、球杆以及初速度等。

            2-1-5-3键盘消息的处理 在可操作状态下，控制游戏的启停、热键等。

    2-2网络服务器

        实现功能：网络互联对战，游戏比赛逻辑，用户资料管理。

        2-2-1网络互联对战 采用类似QQ游戏的那种方式，可以多人观看，管理球桌资源的分发和回收。

        2-2-2游戏比赛逻辑 获胜方给于加分等操作

        2-2-3用户资料管理 用户的身份验证，资料更新。


*3、游戏素材与同步测试

    3-1游戏的素材采用文件的方式存储在连同程序一起的相同目录下，包括球的参数：大小、颜色，球桌的参数：大小、帖图，球杆的参数：大小、帖图，系统的物理模型参数：摩擦系数、弹性系数、最大速度、最小速度，粒子系统：粒子片元，个数，寿命，颜色等。

    3-2游戏的素材会专门做一个编辑器出来，设计和测试出合适的参数。

    3-3网络服务器部分如果单独开始，可以专门做一个测试器，用于模拟测试网络状况，负载和速度等。

*4、设计文档和程序规范

    4-1面向对象的设计，类设计文档中应该包括：类的功能，类的公共接口功能，接口参数意义，返回值意义等，语言简洁明确。例如：

类名称：CWnd

主要功能：封装窗口的创建，使用和销毁，处理窗口函数。

继承类：有就填，没有就填无

外部接口：


virtual BOOL Create( LPCTSTR lpszClassName, LPCTSTR lpszWindowName, DWORD dwStyle, const RECT& rect, CWnd* pParentWnd, UINT nID, CCreateContext* pContext = NULL);

返回值：

成功返回非零值，否则0。

参数：

lpszClassName

指向一个空终止的字符串用于命名窗口类（一个WNDCLASS结构体）。这个类名可以是任何用AfxRegisterWndClass函数注册过的名字，或者是任何被预先定义过的控制类名字。如果为NULL，表示使用缺省的CWnd属性。

...

备注：
如何创建一个Windows的子窗口同时关联它到CWnd对象。

你可以分两步创建一个子窗口。首先，调用构造函数构造CWnd对象，然后调用Create创建Windows子窗口并关联它到CWnd。Create初始化这个窗口的类名和窗口名以及注册style, parent和ID值。

其它接口

    4-2源程序规范

    指名实现的哪一个模块的模块编号、哪一个类的类编号，以及必要的实现注释。

    4-3命名规范[推荐]

    采用匈牙利名命法，同MFC中一致，具体查相关资料。主要思想是，在命名中反应它的类型，作用域和意义，主要有：
    g_ 全局，m_ 成员

    lp 指针，n 32位整型，b 布尔型，dw 双字类型

    表示意义的部分头一个字母大字

    类名的最前一个字母是C class

    结构体用全大写

    函数用一个动词（或词组），各节词头一个字母大写

    宏定义用_分隔各节，并且全大写

比如：

    m_lpszName 一个成员变量，是一个以0结尾的字符串，它的意义是一个名字

    CWnd 类

    CREATESTRUCT 结构体

    SetWindowLong 函数

    WM_TIMER 宏定义的消息


_[附注]_本文档将成为第一个正式文档，可由其它开发人员商讨和修改，在后面的开发过程当中，对问题的描述，可以使用文档编号描述，比如用Architecture_Doc[2-1-5] 代替 游戏消息处理过程 之说明。